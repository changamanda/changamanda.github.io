
<!DOCTYPE HTML>
<html lang="en-GB">
<head>
	<meta charset="utf-8">
	<title>Understanding Procs for Sorting in Ruby – Part Two  | A Computer Walks Into A Bar</title>

	<meta name="author" content="Amanda Chang">

<meta name="description" content="A Computer Walks Into A Bar"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="A Computer Walks Into A Bar" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>



<body>
	<header id="header" class="inner"><h1><a href="/">A Computer Walks Into A Bar</a></h1>
<img src="http://i.imgur.com/DsIx2tl.png" height="140px">
<nav id="main-nav"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/about">About</a></li>
	<li><a href="/archives">Archives</a></li>
	<li><a href="/contact">Contact</a></li>
</ul>
</div>
	</div>
</nav>


</header>

	<div id="content" class="inner"><article class="post">
	<header>
		<h2 class="title">Understanding Procs for Sorting in Ruby – Part Two</h2>
		<div class="meta date">








  


<time datetime="2015-06-09T15:11:17-04:00" pubdate data-updated="true"></time></div>
	</header>
	<div class="entry-content"><h2>Recap</h2>

<p><a href="http://computerwalksintobar.com/blog/2015/06/08/understanding-procs-for-sorting-in-ruby-part-one/">Last time</a>, we discussed procs and how to use them to set default blocks for Ruby methods.</p>

<p>A reminder:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>  <span class="n">normalized_block</span> <span class="o">=</span> <span class="n">block</span> <span class="o">||</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span><span class="p">{</span> <span class="o">|</span><span class="n">word</span><span class="o">|</span> <span class="n">word</span><span class="o">.</span><span class="n">capitalize</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">normalized_block</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">do_something</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'><span class="n">do_something</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">){</span> <span class="o">|</span><span class="n">word</span><span class="o">|</span> <span class="n">word</span><span class="o">.</span><span class="n">capitalize</span> <span class="p">}</span>
</span><span class='line'>  <span class="o">=&gt;</span> <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'><span class="n">do_something</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">){</span> <span class="o">|</span><span class="n">word</span><span class="o">|</span> <span class="n">word</span><span class="o">.</span><span class="n">upcase</span> <span class="p">}</span>
</span><span class='line'>  <span class="o">=&gt;</span> <span class="s2">&quot;HELLO&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><br><center><img src="http://media0.giphy.com/media/gtmEIOOOHVgHK/giphy.gif"></center></p>

<h2>Insertion Sort – Integers</h2>

<p>According to <a href="http://en.wikipedia.org/wiki/Insertion_sort">Wikipedia</a>, insertion sort &ldquo;is a simple sorting algorithm that builds the final sorted array (or list) one item at a time.&rdquo; Essentially, insertion sort works by keeping track of a sorted sub-list, and placing each element in the correct position in that sorted sub-list.</p>

<p>First, let&rsquo;s implement insertion sort with simple integers in ascending order.</p>

<p>So if we implement a method that inserts an element at the correct place in a sorted array, this sort should be easy. If the element is less than or equal to any other element in the sorted array, we should insert the new element before this existing element; otherwise, we should put the new element at the end:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">insert_in_right_place</span><span class="p">(</span><span class="n">sorted_list</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sorted_list</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">list_el</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">sorted_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span> <span class="o">&lt;=</span> <span class="n">list_el</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">sorted_list</span> <span class="o">&lt;&lt;</span> <span class="n">element</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, to sort an array of integers, we just have to iterate through it, placing each element in the sorted sub-list:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sorted</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="n">array</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">element</span><span class="o">|</span>
</span><span class='line'>    <span class="n">sorted</span> <span class="o">=</span> <span class="n">insert_in_right_place</span><span class="p">(</span><span class="n">sorted</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">sorted</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This can be refactored as:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</span><span class='line'>  <span class="n">array</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="o">[]</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">sorted</span><span class="p">,</span> <span class="n">element</span><span class="o">|</span> <span class="n">insert_in_right_place</span><span class="p">(</span><span class="n">sorted</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Sort By Condition</h2>

<p>But what if we want to sort by an optional, user-entered block? ENTER: PROCS.</p>

<p>In Ruby, the spaceship operator <code>a &lt;=&gt; b</code> compares two items, returning 1 if <code>a &gt; b</code>, 0 if <code>a == b</code>, and -1 if <code>a &lt; b</code>. For example, <code>3 &lt;=&gt; 2</code> returns 1, whereas <code>2 &lt;=&gt; 3</code> returns -1. <code>2 &lt;=&gt; 2</code> returns 0.</p>

<p>Let&rsquo;s give our sort an optional block variable <code>&amp;block</code>, so the user can enter his or her own sorting condition. The default condition should be the typical <code>a &lt;=&gt; b</code> comparison. Now, <code>#sort</code> becomes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>  <span class="n">normalized_block</span> <span class="o">=</span> <span class="n">block</span> <span class="o">||</span> <span class="no">Proc</span><span class="o">.</span><span class="n">new</span><span class="p">{</span><span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">|</span> <span class="n">a</span> <span class="o">&lt;=&gt;</span> <span class="n">b</span><span class="p">}</span>
</span><span class='line'>  <span class="n">array</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="o">[]</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">sorted</span><span class="p">,</span> <span class="n">element</span><span class="o">|</span> <span class="n">insert_in_right_place</span><span class="p">(</span><span class="n">sorted</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">normalized_block</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This block becomes what we <strong>check</strong> in <code>#insert_in_right_place</code>, which becomes:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">insert_in_right_place</span><span class="p">(</span><span class="n">sorted_list</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sorted_list</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">list_el</span><span class="p">,</span> <span class="n">i</span><span class="o">|</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">sorted_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">list_el</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">sorted_list</span> <span class="o">&lt;&lt;</span> <span class="n">element</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>So let&rsquo;s try some examples:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">[</span><span class="s2">&quot;aardvark&quot;</span><span class="p">,</span> <span class="s2">&quot;deer&quot;</span><span class="p">,</span> <span class="s2">&quot;elephant&quot;</span><span class="p">,</span> <span class="s2">&quot;blowfish&quot;</span><span class="p">,</span> <span class="s2">&quot;hamster&quot;</span><span class="p">,</span> <span class="s2">&quot;crocodile&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="o">].</span><span class="n">sort</span>
</span><span class='line'>  <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;aardvark&quot;</span><span class="p">,</span> <span class="s2">&quot;blowfish&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;crocodile&quot;</span><span class="p">,</span> <span class="s2">&quot;deer&quot;</span><span class="p">,</span> <span class="s2">&quot;elephant&quot;</span><span class="p">,</span> <span class="s2">&quot;hamster&quot;</span><span class="o">]</span>
</span><span class='line'><span class="o">[</span><span class="s2">&quot;deer&quot;</span><span class="p">,</span> <span class="s2">&quot;blowfish&quot;</span><span class="p">,</span> <span class="s2">&quot;hamster&quot;</span><span class="p">,</span> <span class="s2">&quot;crocodile&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="o">].</span><span class="n">sort</span><span class="p">{</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">|</span> <span class="n">a</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">&lt;=&gt;</span> <span class="n">b</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="p">}</span>
</span><span class='line'>  <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;hamster&quot;</span><span class="p">,</span> <span class="s2">&quot;deer&quot;</span><span class="p">,</span> <span class="s2">&quot;blowfish&quot;</span><span class="p">,</span> <span class="s2">&quot;crocodile&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p><br><center><img src="http://media.giphy.com/media/JdCz7YXOZAURq/giphy.gif"></center></p>
</div>
	

</article>

	
	<div class="share">
		<ul>
			<li>
  <a href="https://twitter.com/intent/tweet?text=Understanding Procs for Sorting in Ruby – Part Two by @&url=http://computerwalksintobar.com/blog/2015/06/09/understanding-procs-for-sorting-in-ruby-part-two/" title="Share Understanding Procs for Sorting in Ruby – Part Two on Twitter">
    <img src="/images/social/twitter.png" />
  </a>
</li>

			<li>
  <a href="https://www.facebook.com/sharer.php?u=http://computerwalksintobar.com/blog/2015/06/09/understanding-procs-for-sorting-in-ruby-part-two/" title="Share Understanding Procs for Sorting in Ruby – Part Two on Facebook">
    <img src="/images/social/facebook.png" />
  </a>
</li>

			<li>
  <a href="https://plus.google.com/share?url=http://computerwalksintobar.com/blog/2015/06/09/understanding-procs-for-sorting-in-ruby-part-two/" title="Share Understanding Procs for Sorting in Ruby – Part Two on Google Plus">
    <img src="/images/social/google.png" />
  </a>
</li>

		</ul>
	</div>



</div>
	<footer id="footer" class="inner">&copy; 2015

    Amanda Chang

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/hyphenator.js"></script>







</body>
</html>
